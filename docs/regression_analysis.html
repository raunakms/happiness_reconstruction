<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Regression Analysis: Happiness and its Potential Predictors</title>

<script src="site_libs/header-attrs-2.1/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="data_preprocess.html">Data Pre-process</a>
</li>
<li>
  <a href="choropleth_maps.html">Choropleth Maps</a>
</li>
<li>
  <a href="exploratory_analysis.html">Exploratory Analysis</a>
</li>
<li>
  <a href="regression_analysis.html">Regression Analysis</a>
</li>
<li>
  <a href="inequality_analysis.html">Inequality Analysis</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Regression Analysis: Happiness and its Potential Predictors</h1>

</div>


<div id="define-libraries" class="section level4">
<h4>Define Libraries</h4>
<pre class="r"><code>library(&quot;stringr&quot;)
library(&quot;MASS&quot;)
library(&quot;dplyr&quot;)
library(&quot;car&quot;)
library(&quot;knitr&quot;)
library(&quot;effects&quot;)
library(&quot;ggplot2&quot;)
library(&quot;gridExtra&quot;)
library(&quot;brant&quot;)
library(&quot;VGAM&quot;)
library(&quot;sandwich&quot;)
library(&quot;lmtest&quot;)</code></pre>
</div>
<div id="define-path" class="section level4">
<h4>Define Path</h4>
<pre class="r"><code>dir.wrk &lt;- getwd()
dir.data &lt;- file.path(dir.wrk, &quot;dataset/data&quot;)
dir.annot &lt;- file.path(dir.wrk, &quot;dataset/annotation&quot;)</code></pre>
</div>
<div id="define-files" class="section level4">
<h4>Define Files</h4>
<pre class="r"><code>file.dat &lt;- file.path(dir.data, &quot;mastertbl_household_reconstruction.tsv&quot;)</code></pre>
</div>
<div id="load-data" class="section level4">
<h4>Load Data</h4>
<pre class="r"><code>dat &lt;- read.delim(file.dat, header = TRUE, stringsAsFactors = FALSE)

# FACTORIZE ---
dat$DISTRICT &lt;- factor(dat$DISTRICT, levels = c(&quot;Dhading&quot;, &quot;Sindhupalchowk&quot;))
dat$VDC_MUN &lt;- factor(dat$VDC_MUN, levels = c(&quot;Gumdi&quot;, &quot;Sertung&quot;, &quot;Batase&quot;, &quot;Pangtang&quot;))
dat$WARD &lt;- as.factor(dat$WARD)
dat$SEX &lt;- factor(dat$SEX, levels = c(&quot;Male&quot;, &quot;Female&quot;))
dat$ETHNICITY &lt;- factor(dat$ETHNICITY, levels = c(&quot;Bahun&quot;, &quot;Chhetri&quot;, &quot;Dalit-Others&quot;, 
    &quot;Gurung-Magar&quot;, &quot;Newar&quot;, &quot;Tamang&quot;))
dat$EDUCATION_LEVEL &lt;- factor(dat$EDUCATION_LEVEL, levels = c(&quot;Illiterate&quot;, &quot;Primary&quot;, 
    &quot;Secondary&quot;, &quot;University&quot;))
dat$OCCUPATION &lt;- factor(dat$OCCUPATION, levels = c(&quot;Agriculture&quot;, &quot;Business&quot;, &quot;Goverment Employee&quot;, 
    &quot;Labour&quot;, &quot;Teacher&quot;))
dat$INCOME_LEVEL &lt;- factor(dat$INCOME_LEVEL, levels = c(&quot;0-2.5K&quot;, &quot;2.5-10K&quot;, &quot;10-20K&quot;, 
    &quot;20-40K&quot;, &quot;40-60K&quot;, &quot;60K-Above&quot;))
dat$RECON_COMPLETED &lt;- as.factor(dat$RECON_COMPLETED)
dat$SATISFACTION_LEVEL &lt;- as.factor(dat$SATISFACTION_LEVEL)
dat$FREEDOM_CHOICE &lt;- as.factor(dat$FREEDOM_CHOICE)

# str(dat)</code></pre>
<p></br></br></p>
</div>
<div id="ordered-logistic-regression-between-satisfaction-level-and-its-all-potential-predictors" class="section level3">
<h3>Ordered Logistic Regression between Satisfaction Level and its all potential predictors</h3>
<pre class="r"><code># FIT ORDERED LOGISTIC REGRESSION ---
fit.mc &lt;- MASS::polr(SATISFACTION_LEVEL ~ SEX+ETHNICITY+FREEDOM_CHOICE+EDUCATION_LEVEL+OCCUPATION+RECON_COMPLETED+DISTRICT+INCOME_LEVEL+AGE, data=dat, Hess=TRUE, method=&quot;logistic&quot;)

# CALCULATE P-VALUE ---
summary_table &lt;- coef(summary(fit.mc))
pval &lt;- pnorm(abs(summary_table[, &quot;t value&quot;]), lower.tail=FALSE)* 2
summary_table &lt;- cbind(summary_table, &quot;p value&quot;=round(pval,4))

# CALCULATE LOG-ODDS RATIO ---
tbl_oddratio &lt;- exp(cbind(OddRatio=coef(fit.mc), confint(fit.mc, level=0.95)))

# AGGREGATE DATA ---
summary_table_var &lt;- as.data.frame(cbind(summary_table[1:nrow(tbl_oddratio),], tbl_oddratio))

rmarkdown::paged_table(format(summary_table_var, digits=3), options=list(rows.print=10))  </code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Value"],"name":[1],"type":["S3: AsIs"],"align":["right"]},{"label":["Std. Error"],"name":[2],"type":["S3: AsIs"],"align":["right"]},{"label":["t value"],"name":[3],"type":["S3: AsIs"],"align":["right"]},{"label":["p value"],"name":[4],"type":["S3: AsIs"],"align":["right"]},{"label":["OddRatio"],"name":[5],"type":["S3: AsIs"],"align":["right"]},{"label":["2.5 %"],"name":[6],"type":["S3: AsIs"],"align":["right"]},{"label":["97.5 %"],"name":[7],"type":["S3: AsIs"],"align":["right"]}],"data":[{"1":"-0.54710","2":"0.24472","3":"-2.23564","4":"0.0254","5":"0.579","6":"0.3572","7":"0.933","_rn_":"SEXFemale"},{"1":"-0.46027","2":"0.40849","3":"-1.12677","4":"0.2598","5":"0.631","6":"0.2823","7":"1.404","_rn_":"ETHNICITYChhetri"},{"1":"-0.74168","2":"0.43252","3":"-1.71479","4":"0.0864","5":"0.476","6":"0.2028","7":"1.108","_rn_":"ETHNICITYDalit-Others"},{"1":"-0.85447","2":"0.37642","3":"-2.27001","4":"0.0232","5":"0.426","6":"0.2024","7":"0.888","_rn_":"ETHNICITYGurung-Magar"},{"1":"-0.80109","2":"0.44384","3":"-1.80489","4":"0.0711","5":"0.449","6":"0.1873","7":"1.070","_rn_":"ETHNICITYNewar"},{"1":"-1.49919","2":"0.39294","3":"-3.81536","4":"0.0001","5":"0.223","6":"0.1025","7":"0.480","_rn_":"ETHNICITYTamang"},{"1":"1.07932","2":"0.98991","3":"1.09032","4":"0.2756","5":"2.943","6":"0.4179","7":"19.733","_rn_":"FREEDOM_CHOICE2"},{"1":"1.10502","2":"0.55899","3":"1.97682","4":"0.0481","5":"3.019","6":"1.0048","7":"9.030","_rn_":"FREEDOM_CHOICE3"},{"1":"1.06516","2":"0.46387","3":"2.29626","4":"0.0217","5":"2.901","6":"1.1710","7":"7.234","_rn_":"FREEDOM_CHOICE4"},{"1":"1.23205","2":"0.41766","3":"2.94990","4":"0.0032","5":"3.428","6":"1.5139","7":"7.802","_rn_":"FREEDOM_CHOICE5"},{"1":"2.12430","2":"0.43241","3":"4.91265","4":"0.0000","5":"8.367","6":"3.6057","7":"19.689","_rn_":"FREEDOM_CHOICE6"},{"1":"2.54088","2":"0.43753","3":"5.80727","4":"0.0000","5":"12.691","6":"5.4148","7":"30.165","_rn_":"FREEDOM_CHOICE7"},{"1":"2.85252","2":"0.52479","3":"5.43554","4":"0.0000","5":"17.331","6":"6.2197","7":"48.890","_rn_":"FREEDOM_CHOICE8"},{"1":"3.84806","2":"0.56704","3":"6.78626","4":"0.0000","5":"46.902","6":"15.6620","7":"145.663","_rn_":"FREEDOM_CHOICE9"},{"1":"3.53091","2":"0.48644","3":"7.25871","4":"0.0000","5":"34.155","6":"13.2864","7":"89.651","_rn_":"FREEDOM_CHOICE10"},{"1":"0.28630","2":"0.28046","3":"1.02079","4":"0.3074","5":"1.331","6":"0.7680","7":"2.308","_rn_":"EDUCATION_LEVELPrimary"},{"1":"0.18583","2":"0.31769","3":"0.58493","4":"0.5586","5":"1.204","6":"0.6458","7":"2.247","_rn_":"EDUCATION_LEVELSecondary"},{"1":"0.00759","2":"0.84202","3":"0.00901","4":"0.9928","5":"1.008","6":"0.1894","7":"5.321","_rn_":"EDUCATION_LEVELUniversity"},{"1":"-0.46840","2":"0.34339","3":"-1.36405","4":"0.1726","5":"0.626","6":"0.3180","7":"1.226","_rn_":"OCCUPATIONBusiness"},{"1":"-0.69809","2":"0.62457","3":"-1.11772","4":"0.2637","5":"0.498","6":"0.1455","7":"1.723","_rn_":"OCCUPATIONGoverment Employee"},{"1":"-0.25998","2":"0.29417","3":"-0.88378","4":"0.3768","5":"0.771","6":"0.4324","7":"1.372","_rn_":"OCCUPATIONLabour"},{"1":"0.12429","2":"1.10899","3":"0.11207","4":"0.9108","5":"1.132","6":"0.1131","7":"11.228","_rn_":"OCCUPATIONTeacher"},{"1":"1.00383","2":"0.65012","3":"1.54407","4":"0.1226","5":"2.729","6":"0.7568","7":"9.755","_rn_":"RECON_COMPLETED40"},{"1":"-0.04740","2":"0.76246","3":"-0.06217","4":"0.9504","5":"0.954","6":"0.2113","7":"4.286","_rn_":"RECON_COMPLETED60"},{"1":"0.23313","2":"0.47299","3":"0.49290","4":"0.6221","5":"1.263","6":"0.4985","7":"3.199","_rn_":"RECON_COMPLETED80"},{"1":"0.54367","2":"0.40972","3":"1.32693","4":"0.1845","5":"1.722","6":"0.7692","7":"3.856","_rn_":"RECON_COMPLETED100"},{"1":"0.38914","2":"0.23814","3":"1.63405","4":"0.1022","5":"1.476","6":"0.9261","7":"2.358","_rn_":"DISTRICTSindhupalchowk"},{"1":"-0.47999","2":"0.37785","3":"-1.27031","4":"0.2040","5":"0.619","6":"0.2938","7":"1.297","_rn_":"INCOME_LEVEL2.5-10K"},{"1":"-0.32210","2":"0.39915","3":"-0.80698","4":"0.4197","5":"0.725","6":"0.3292","7":"1.580","_rn_":"INCOME_LEVEL10-20K"},{"1":"-0.27204","2":"0.42854","3":"-0.63481","4":"0.5256","5":"0.762","6":"0.3274","7":"1.763","_rn_":"INCOME_LEVEL20-40K"},{"1":"-0.95603","2":"0.72398","3":"-1.32051","4":"0.1867","5":"0.384","6":"0.0901","7":"1.576","_rn_":"INCOME_LEVEL40-60K"},{"1":"-1.55837","2":"1.02219","3":"-1.52454","4":"0.1274","5":"0.210","6":"0.0270","7":"1.616","_rn_":"INCOME_LEVEL60K-Above"},{"1":"-0.00571","2":"0.00882","3":"-0.64697","4":"0.5177","5":"0.994","6":"0.9772","7":"1.012","_rn_":"AGE"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="analysis-of-deviance" class="section level3">
<h3>Analysis of deviance</h3>
<pre class="r"><code># ANOVA 
car::Anova(fit.mc)</code></pre>
<pre><code>## Analysis of Deviance Table (Type II tests)
## 
## Response: SATISFACTION_LEVEL
##                 LR Chisq Df Pr(&gt;Chisq)    
## SEX                5.036  1   0.024823 *  
## ETHNICITY         18.175  5   0.002734 ** 
## FREEDOM_CHOICE   103.834  9  &lt; 2.2e-16 ***
## EDUCATION_LEVEL    1.097  3   0.777837    
## OCCUPATION         3.252  4   0.516514    
## RECON_COMPLETED    4.139  4   0.387569    
## DISTRICT           2.679  1   0.101701    
## INCOME_LEVEL       4.282  5   0.509548    
## AGE                0.419  1   0.517282    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The above analysis reveals that the effects of variables such as, location, education, income, physical level of reconstruction, and occupation on the self-reported level of happiness are not statistically significant (at 95% confidence level). However, the effects of variables such as, Sex, Ethnicity, and Freedom of Choice on the happiness level were found to statistically significant. Thus, we redo the above analysis considering only Sex, Ethinicity, and Freedom of Choice. </br></br></p>
</div>
<div id="ordered-logistic-regression-between-satisfaction-level-and-its-potential-predictors" class="section level3">
<h3>Ordered Logistic Regression between Satisfaction Level and its potential predictors</h3>
<pre class="r"><code># FIT ORDERED LOGISTIC REGRESSION ---
fit.m &lt;- MASS::polr(SATISFACTION_LEVEL ~ SEX+ETHNICITY+FREEDOM_CHOICE, data=dat, Hess=TRUE, method=&quot;logistic&quot;)

# CALCULATE P-VALUE ---
summary_table &lt;- coef(summary(fit.m))
pval &lt;- pnorm(abs(summary_table[, &quot;t value&quot;]), lower.tail=FALSE)* 2
summary_table &lt;- cbind(summary_table, &quot;p value&quot;=round(pval,4))

# CALCULATE LOG-ODDS RATIO ---
tbl_oddratio &lt;- exp(cbind(OddRatio=coef(fit.m), confint(fit.m, level=0.95)))

# AGGREGATE DATA ---
summary_table_var &lt;- as.data.frame(cbind(summary_table[1:nrow(tbl_oddratio),], tbl_oddratio))

rmarkdown::paged_table(format(summary_table_var, digits=3), options=list(rows.print=10))  </code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Value"],"name":[1],"type":["S3: AsIs"],"align":["right"]},{"label":["Std. Error"],"name":[2],"type":["S3: AsIs"],"align":["right"]},{"label":["t value"],"name":[3],"type":["S3: AsIs"],"align":["right"]},{"label":["p value"],"name":[4],"type":["S3: AsIs"],"align":["right"]},{"label":["OddRatio"],"name":[5],"type":["S3: AsIs"],"align":["right"]},{"label":["2.5 %"],"name":[6],"type":["S3: AsIs"],"align":["right"]},{"label":["97.5 %"],"name":[7],"type":["S3: AsIs"],"align":["right"]}],"data":[{"1":"-0.385","2":"0.193","3":"-2.00","4":"0.0458","5":"0.680","6":"0.466","7":"0.992","_rn_":"SEXFemale"},{"1":"-0.427","2":"0.384","3":"-1.11","4":"0.2658","5":"0.652","6":"0.307","7":"1.384","_rn_":"ETHNICITYChhetri"},{"1":"-0.585","2":"0.387","3":"-1.51","4":"0.1306","5":"0.557","6":"0.259","7":"1.187","_rn_":"ETHNICITYDalit-Others"},{"1":"-0.852","2":"0.348","3":"-2.45","4":"0.0143","5":"0.427","6":"0.215","7":"0.841","_rn_":"ETHNICITYGurung-Magar"},{"1":"-0.617","2":"0.412","3":"-1.50","4":"0.1338","5":"0.539","6":"0.240","7":"1.208","_rn_":"ETHNICITYNewar"},{"1":"-1.290","2":"0.338","3":"-3.81","4":"0.0001","5":"0.275","6":"0.141","7":"0.532","_rn_":"ETHNICITYTamang"},{"1":"1.090","2":"1.000","3":"1.09","4":"0.2759","5":"2.973","6":"0.404","7":"19.431","_rn_":"FREEDOM_CHOICE2"},{"1":"0.901","2":"0.515","3":"1.75","4":"0.0801","5":"2.463","6":"0.894","7":"6.764","_rn_":"FREEDOM_CHOICE3"},{"1":"0.842","2":"0.440","3":"1.91","4":"0.0557","5":"2.321","6":"0.981","7":"5.520","_rn_":"FREEDOM_CHOICE4"},{"1":"1.004","2":"0.392","3":"2.56","4":"0.0104","5":"2.728","6":"1.269","7":"5.911","_rn_":"FREEDOM_CHOICE5"},{"1":"1.896","2":"0.404","3":"4.69","4":"0.0000","5":"6.659","6":"3.033","7":"14.823","_rn_":"FREEDOM_CHOICE6"},{"1":"2.246","2":"0.407","3":"5.52","4":"0.0000","5":"9.446","6":"4.283","7":"21.131","_rn_":"FREEDOM_CHOICE7"},{"1":"2.658","2":"0.501","3":"5.31","4":"0.0000","5":"14.268","6":"5.365","7":"38.364","_rn_":"FREEDOM_CHOICE8"},{"1":"3.681","2":"0.536","3":"6.86","4":"0.0000","5":"39.671","6":"14.029","7":"115.644","_rn_":"FREEDOM_CHOICE9"},{"1":"3.398","2":"0.468","3":"7.26","4":"0.0000","5":"29.897","6":"12.051","7":"75.683","_rn_":"FREEDOM_CHOICE10"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># SATISFACTION THRESHOLD ---
summary_table_st &lt;- as.data.frame(summary_table[(nrow(tbl_oddratio)+1):nrow(summary_table),])
rmarkdown::paged_table(summary_table_st)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Value"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Std. Error"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["t value"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["p value"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"-4.354152110","2":"0.6400615","3":"-6.80270935","4":"0.0000","_rn_":"1|2"},{"1":"-3.637858202","2":"0.5351275","3":"-6.79811451","4":"0.0000","_rn_":"2|3"},{"1":"-3.125382051","2":"0.4893598","3":"-6.38667528","4":"0.0000","_rn_":"3|4"},{"1":"-2.276050052","2":"0.4466694","3":"-5.09560286","4":"0.0000","_rn_":"4|5"},{"1":"-0.008819105","2":"0.4304472","3":"-0.02048824","4":"0.9837","_rn_":"5|6"},{"1":"0.742962166","2":"0.4344919","3":"1.70995637","4":"0.0873","_rn_":"6|7"},{"1":"1.518030537","2":"0.4386970","3":"3.46031650","4":"0.0005","_rn_":"7|8"},{"1":"2.397088221","2":"0.4460030","3":"5.37460060","4":"0.0000","_rn_":"8|9"},{"1":"2.914564409","2":"0.4535054","3":"6.42674655","4":"0.0000","_rn_":"9|10"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="analysis-of-deviance-1" class="section level3">
<h3>Analysis of deviance</h3>
<pre class="r"><code># ANOVA 
car::Anova(fit.m)</code></pre>
<pre><code>## Analysis of Deviance Table (Type II tests)
## 
## Response: SATISFACTION_LEVEL
##                LR Chisq Df Pr(&gt;Chisq)    
## SEX               4.008  1   0.045273 *  
## ETHNICITY        18.659  5   0.002224 ** 
## FREEDOM_CHOICE  105.780  9  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="heteroscedasticity-robust-stdandard-errors-and-p-values" class="section level3">
<h3>Heteroscedasticity Robust stdandard errors and p-values</h3>
<pre class="r"><code>#lmtest::coeftest(fit.m, vcov = sandwich::vcovHC(fit.m, type = &quot;HC0&quot;))
coef_t &lt;- lmtest::coeftest(fit.m)

coef_t</code></pre>
<pre><code>## 
## t test of coefficients:
## 
##                       Estimate Std. Error t value  Pr(&gt;|t|)    
## SEXFemale             -0.38499    0.19275 -1.9973 0.0465478 *  
## ETHNICITYChhetri      -0.42708    0.38381 -1.1127 0.2665783    
## ETHNICITYDalit-Others -0.58535    0.38720 -1.5117 0.1314839    
## ETHNICITYGurung-Magar -0.85210    0.34787 -2.4495 0.0147853 *  
## ETHNICITYNewar        -0.61719    0.41166 -1.4993 0.1346887    
## ETHNICITYTamang       -1.29017    0.33836 -3.8130 0.0001617 ***
## FREEDOM_CHOICE2        1.08959    1.00006  1.0895 0.2766578    
## FREEDOM_CHOICE3        0.90142    0.51501  1.7503 0.0809288 .  
## FREEDOM_CHOICE4        0.84210    0.44009  1.9135 0.0564880 .  
## FREEDOM_CHOICE5        1.00371    0.39180  2.5618 0.0108239 *  
## FREEDOM_CHOICE6        1.89603    0.40407  4.6924 3.853e-06 ***
## FREEDOM_CHOICE7        2.24556    0.40651  5.5239 6.398e-08 ***
## FREEDOM_CHOICE8        2.65805    0.50061  5.3097 1.935e-07 ***
## FREEDOM_CHOICE9        3.68063    0.53650  6.8605 3.041e-11 ***
## FREEDOM_CHOICE10       3.39775    0.46811  7.2584 2.465e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="odds-ratios-with-robust-confidence-intervals" class="section level3">
<h3>Odds Ratios with robust confidence intervals</h3>
<pre class="r"><code>#robust_sr &lt;- sqrt(diag( sandwich::vcovHC(fit.m, type = &quot;HC0&quot;) ))
#y_or &lt;- exp(coef(fit.m))
#robust_or &lt;- cbind(coef_t, y_or, LL=exp(coef(fit.m) - 1.96 * robust_sr), UL = exp(coef(fit.m) + 1.96 * robust_sr))

#robust_or</code></pre>
</div>
<div id="test-for-proportional-odds-assumption" class="section level3">
<h3>Test for Proportional Odds assumption</h3>
<pre class="r"><code>suppressWarnings(brant::brant(fit.m))</code></pre>
<pre><code>## ---------------------------------------------------- 
## Test for     X2  df  probability 
## ---------------------------------------------------- 
## Omnibus          5928.51 120 0
## SEXFemale        27.11   8   0
## ETHNICITYChhetri 2.2 8   0.97
## ETHNICITYDalit-Others    2.17    8   0.98
## ETHNICITYGurung-Magar    2.86    8   0.94
## ETHNICITYNewar       5.42    8   0.71
## ETHNICITYTamang  1.9 8   0.98
## FREEDOM_CHOICE2  19.35   8   0.01
## FREEDOM_CHOICE3  9.99    8   0.27
## FREEDOM_CHOICE4  10.65   8   0.22
## FREEDOM_CHOICE5  10.2    8   0.25
## FREEDOM_CHOICE6  27.36   8   0
## FREEDOM_CHOICE7  25.44   8   0
## FREEDOM_CHOICE8  13.19   8   0.11
## FREEDOM_CHOICE9  4.92    8   0.77
## FREEDOM_CHOICE10 12.01   8   0.15
## ---------------------------------------------------- 
## 
## H0: Parallel Regression Assumption holds</code></pre>
<pre><code>##                                X2  df  probability
## Omnibus               5928.509021 120 0.0000000000
## SEXFemale               27.112382   8 0.0006760777
## ETHNICITYChhetri         2.199557   8 0.9742745286
## ETHNICITYDalit-Others    2.166315   8 0.9754837970
## ETHNICITYGurung-Magar    2.864757   8 0.9425557787
## ETHNICITYNewar           5.419212   8 0.7119732074
## ETHNICITYTamang          1.898275   8 0.9839731742
## FREEDOM_CHOICE2         19.347883   8 0.0131058967
## FREEDOM_CHOICE3          9.988154   8 0.2658583091
## FREEDOM_CHOICE4         10.648955   8 0.2223939392
## FREEDOM_CHOICE5         10.203099   8 0.2510594492
## FREEDOM_CHOICE6         27.361064   8 0.0006123065
## FREEDOM_CHOICE7         25.436778   8 0.0013104830
## FREEDOM_CHOICE8         13.187097   8 0.1055722918
## FREEDOM_CHOICE9          4.919087   8 0.7661881672
## FREEDOM_CHOICE10        12.009860   8 0.1507645135</code></pre>
</div>
<div id="bootstrapping-of-odds-ratio-or-with-95-ci-typebca-or-expcoef" class="section level3">
<h3>Bootstrapping of Odds ratio (OR) with 95% CI (Type=bca): OR = exp(coef)</h3>
<pre class="r"><code>or_boot &lt;- suppressWarnings(car::Boot(fit.m, f = function(fit.m) exp(coef(fit.m)), R=1000))
df.or_boot &lt;- format(as.data.frame(confint(or_boot, type=&quot;bca&quot;)), digits=3, scientific=FALSE)

knitr::kable(df.or_boot, align=&quot;ll&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">2.5 %</th>
<th align="left">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SEXFemale</td>
<td align="left">0.4544</td>
<td align="left">0.999</td>
</tr>
<tr class="even">
<td>ETHNICITYChhetri</td>
<td align="left">0.3086</td>
<td align="left">1.523</td>
</tr>
<tr class="odd">
<td>ETHNICITYDalit-Others</td>
<td align="left">0.2478</td>
<td align="left">1.204</td>
</tr>
<tr class="even">
<td>ETHNICITYGurung-Magar</td>
<td align="left">0.2143</td>
<td align="left">0.867</td>
</tr>
<tr class="odd">
<td>ETHNICITYNewar</td>
<td align="left">0.2386</td>
<td align="left">1.258</td>
</tr>
<tr class="even">
<td>ETHNICITYTamang</td>
<td align="left">0.1316</td>
<td align="left">0.542</td>
</tr>
<tr class="odd">
<td>FREEDOM_CHOICE2</td>
<td align="left">0.0795</td>
<td align="left">62.753</td>
</tr>
<tr class="even">
<td>FREEDOM_CHOICE3</td>
<td align="left">0.7449</td>
<td align="left">6.640</td>
</tr>
<tr class="odd">
<td>FREEDOM_CHOICE4</td>
<td align="left">0.7409</td>
<td align="left">6.631</td>
</tr>
<tr class="even">
<td>FREEDOM_CHOICE5</td>
<td align="left">1.1123</td>
<td align="left">5.945</td>
</tr>
<tr class="odd">
<td>FREEDOM_CHOICE6</td>
<td align="left">2.7608</td>
<td align="left">14.790</td>
</tr>
<tr class="even">
<td>FREEDOM_CHOICE7</td>
<td align="left">3.5083</td>
<td align="left">20.042</td>
</tr>
<tr class="odd">
<td>FREEDOM_CHOICE8</td>
<td align="left">2.8888</td>
<td align="left">32.415</td>
</tr>
<tr class="even">
<td>FREEDOM_CHOICE9</td>
<td align="left">10.4662</td>
<td align="left">117.713</td>
</tr>
<tr class="odd">
<td>FREEDOM_CHOICE10</td>
<td align="left">7.5930</td>
<td align="left">91.723</td>
</tr>
</tbody>
</table>
</div>
<div id="bootstrapping-for-coeffcients-with-95-ci-type-bca" class="section level3">
<h3>Bootstrapping for Coeffcients with 95% CI (Type= bca)</h3>
<pre class="r"><code>beta_boot &lt;- suppressWarnings(car::Boot(fit.m, R=1000))
df.beta_boot &lt;- format(as.data.frame(confint(beta_boot, type=&quot;bca&quot;)), digits=3, scientific=FALSE)

knitr::kable(df.beta_boot, align=&quot;ll&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">2.5 %</th>
<th align="left">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SEXFemale</td>
<td align="left">-0.793</td>
<td align="left">0.030</td>
</tr>
<tr class="even">
<td>ETHNICITYChhetri</td>
<td align="left">-1.128</td>
<td align="left">0.445</td>
</tr>
<tr class="odd">
<td>ETHNICITYDalit-Others</td>
<td align="left">-1.266</td>
<td align="left">0.173</td>
</tr>
<tr class="even">
<td>ETHNICITYGurung-Magar</td>
<td align="left">-1.546</td>
<td align="left">-0.146</td>
</tr>
<tr class="odd">
<td>ETHNICITYNewar</td>
<td align="left">-1.402</td>
<td align="left">0.283</td>
</tr>
<tr class="even">
<td>ETHNICITYTamang</td>
<td align="left">-1.936</td>
<td align="left">-0.543</td>
</tr>
<tr class="odd">
<td>FREEDOM_CHOICE2</td>
<td align="left">-2.461</td>
<td align="left">4.356</td>
</tr>
<tr class="even">
<td>FREEDOM_CHOICE3</td>
<td align="left">-0.357</td>
<td align="left">2.030</td>
</tr>
<tr class="odd">
<td>FREEDOM_CHOICE4</td>
<td align="left">-0.235</td>
<td align="left">1.724</td>
</tr>
<tr class="even">
<td>FREEDOM_CHOICE5</td>
<td align="left">0.154</td>
<td align="left">1.828</td>
</tr>
<tr class="odd">
<td>FREEDOM_CHOICE6</td>
<td align="left">1.024</td>
<td align="left">2.658</td>
</tr>
<tr class="even">
<td>FREEDOM_CHOICE7</td>
<td align="left">1.363</td>
<td align="left">3.015</td>
</tr>
<tr class="odd">
<td>FREEDOM_CHOICE8</td>
<td align="left">1.512</td>
<td align="left">3.664</td>
</tr>
<tr class="even">
<td>FREEDOM_CHOICE9</td>
<td align="left">2.326</td>
<td align="left">4.695</td>
</tr>
<tr class="odd">
<td>FREEDOM_CHOICE10</td>
<td align="left">2.168</td>
<td align="left">4.549</td>
</tr>
</tbody>
</table>
<p></br></br></p>
</div>
<div id="happinesssatistfaction-level-for-each-level-of-freedom-of-choice" class="section level3">
<h3>Happiness/Satistfaction level for each level of freedom of choice</h3>
<pre class="r"><code># EFFECT OF THE FITTED MODEL ---
ef1 &lt;- effects::Effect(focal.predictors=&quot;FREEDOM_CHOICE&quot;, mod=fit.m, 
                       xlevels=list(FREEDOM_CHOICE = 1:10, 2), latent = TRUE)

#plot(ef1, rug=FALSE)</code></pre>
<pre class="r"><code>#### FUNCTION: plotEffect()
plotEffect &lt;- function(ef.obj){
  # PREPARE DATA ---
  df &lt;- cbind(ef.obj$x, fit=ef.obj$fit, upper=ef.obj$upper, lower=ef.obj$lower)
  dt &lt;- data.frame(Level=names(ef.obj$thresholds), thresholds=ef.obj$thresholds)
  
  # FACTORIZE ---
  df$FREEDOM_CHOICE &lt;- as.numeric(as.character(df$FREEDOM_CHOICE))
  
  # PLOT ---
  p &lt;- ggplot(data = df, aes(x=FREEDOM_CHOICE, y=fit)) +
              geom_hline(yintercept = dt$thresholds[5:9], color=&quot;#D9D9D9&quot;, size=1, linetype=2) +
              #geom_ribbon(aes(ymin=lower, ymax=upper), fill=&quot;#D9D9D9&quot;, alpha=0.5) +
              geom_line(aes(y = fit), color=&quot;#E31A1C&quot;, size=1.5) +
              geom_errorbar(data=df, aes(x=FREEDOM_CHOICE, ymin=upper, ymax=lower), width=0.2, size=1, color=&quot;#969696&quot;) +
              geom_point(color=&quot;#E31A1C&quot;, size=3) +
              scale_x_continuous(breaks=c(1:10), labels=c(1:10)) +
              scale_y_continuous(breaks=dt$thresholds,  labels=dt$Level, name=&quot;Satisfaction Level&quot;,
                    sec.axis=sec_axis(~.*1,name=&quot;Effect&quot;, breaks=seq(-2,4,1), labels=seq(-2,4,1))) +
              theme(
                axis.text.x = element_text(size = 10, color=&quot;#000000&quot;),
                axis.text.y = element_text(size = 10, color=&quot;#000000&quot;),
                axis.title = element_text(size = 10, color=&quot;#000000&quot;),
                plot.title = element_text(size = 10, color=&quot;#000000&quot;, hjust=0.5),
                panel.grid.major = element_blank(),
                panel.grid.minor = element_blank(),
                axis.ticks = element_line(size=0.4, color=&quot;#000000&quot;),   
                strip.text = element_text(size=10, color=&quot;#000000&quot;),
                strip.background = element_rect(fill=&quot;#FFFFFF&quot;, color=&quot;#FFFFFF&quot;),
                panel.background = element_rect(fill=&quot;#FFFFFF&quot;, color=&quot;#000000&quot;),
                legend.text = element_text(size = 10, color=&quot;#000000&quot;),
                legend.title = element_blank(),
                legend.key.size = unit(0.5, &quot;cm&quot;),
                legend.position = &quot;none&quot;) +
            ylab(&quot;Effect&quot;) +
            xlab(&quot;Freedom of Choice&quot;) + 
            ggtitle(&quot;&quot;)
            
  
    return(p)
}</code></pre>
<pre class="r"><code>plotEffect(ef.obj=ef1)</code></pre>
<p><img src="regression_analysis_files/figure-html/unnamed-chunk-17-1.png" width="576" style="display: block; margin: auto;" /></p>
<p></br></br></p>
</div>
<div id="happinesssatistfaction-level-for-freedom-of-choice-by-sex-and-ethnicity" class="section level3">
<h3>Happiness/Satistfaction level for freedom of choice by sex and ethnicity</h3>
<pre class="r"><code># EFFECT OF THE FITTED MODEL ---
ef2 &lt;- effects::Effect(focal.predictors=c(&quot;SEX&quot;,&quot;FREEDOM_CHOICE&quot;,&quot;ETHNICITY&quot;), mod=fit.m, 
                       xlevels=list(FREEDOM_CHOICE = 1:10), latent = TRUE)

#plot(ef2, rug = FALSE, ylim = c(-2.0,4.5))</code></pre>
<pre class="r"><code># FUNCTION: plotEffect_MultiVar()
plotEffect_MultiVar &lt;- function(ef.obj){
  # PREPARE DATA ---
  df &lt;- cbind(ef.obj$x, fit=ef.obj$fit, upper=ef.obj$upper, lower=ef.obj$lower)
  dt &lt;- data.frame(Level=names(ef.obj$thresholds), thresholds=ef.obj$thresholds)
  
  # FACTORIZE ---
  df$FREEDOM_CHOICE &lt;- as.numeric(as.character(df$FREEDOM_CHOICE))
  df$SEX &lt;- factor(df$SEX, levels=c(&quot;Male&quot;,&quot;Female&quot;))
  df$ETHNICITY &lt;- factor(df$ETHNICITY, levels=c(&quot;Bahun&quot;,&quot;Chhetri&quot;,&quot;Dalit-Others&quot;,&quot;Gurung-Magar&quot;,&quot;Newar&quot;,&quot;Tamang&quot;))

  # PLOT ---
  p &lt;- ggplot(data = df, aes(x=FREEDOM_CHOICE, y=fit)) +
              geom_hline(yintercept = dt$thresholds[4:9], color=&quot;#D9D9D9&quot;, size=1, linetype=2) +
              #geom_ribbon(aes(ymin=lower, ymax=upper), fill=&quot;#D9D9D9&quot;, alpha=0.5) +
              geom_line(aes(y = fit), color=&quot;#E31A1C&quot;, size=2) +
              geom_errorbar(data=df, aes(x=FREEDOM_CHOICE, ymin=upper, ymax=lower), width=0.2, size=1, color=&quot;#969696&quot;) +
              geom_point(color=&quot;#E31A1C&quot;, size=2) +
              scale_x_continuous(breaks=c(1:10), labels=c(1:10)) +
              scale_y_continuous(breaks=dt$thresholds,  labels=dt$Level, name=&quot;Satisfaction Level&quot;,
                    sec.axis=sec_axis(~.*1,name=&quot;Effect&quot;, breaks=seq(-2,4,1), labels=seq(-2,4,1))) +
              #facet_grid(ETHNICITY~SEX, scales=&quot;fixed&quot;, space=&quot;fixed&quot;) +
              facet_grid(SEX~ETHNICITY, scales=&quot;fixed&quot;, space=&quot;fixed&quot;) +
              theme(
                axis.text.x = element_text(size = 10, color=&quot;#000000&quot;),
                axis.text.y = element_text(size = 10, color=&quot;#000000&quot;),
                axis.title = element_text(size = 10, color=&quot;#000000&quot;),
                plot.title = element_text(size = 10, color=&quot;#000000&quot;, hjust=0.5),
                panel.grid.major = element_blank(),
                panel.grid.minor = element_blank(),
                axis.ticks = element_line(size=0.4, color=&quot;#000000&quot;),   
                strip.text = element_text(size=10, color=&quot;#000000&quot;),
                strip.background = element_rect(fill=&quot;#FFFFFF&quot;, color=&quot;#FFFFFF&quot;),
                panel.background = element_rect(fill=&quot;#FFFFFF&quot;, color=&quot;#000000&quot;),
                legend.text = element_text(size = 10, color=&quot;#000000&quot;),
                legend.title = element_blank(),
                legend.key.size = unit(0.5, &quot;cm&quot;),
                legend.position = &quot;none&quot;) +
            ylab(&quot;Effect&quot;) +
            xlab(&quot;Freedom of Choice&quot;) + 
            ggtitle(&quot;&quot;)
            
  
    return(p)
}</code></pre>
<pre class="r"><code>plotEffect_MultiVar(ef.obj=ef2)</code></pre>
<p><img src="regression_analysis_files/figure-html/unnamed-chunk-20-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p></br></br></p>
<pre class="r"><code>ef3 &lt;- effects::Effect(focal.predictors=&quot;FREEDOM_CHOICE&quot;, mod=fit.m, 
                       xlevels=list(FREEDOM_CHOICE = 1:10, 2))

#plot(ef3, lines=list(multiline=TRUE), rug=FALSE)</code></pre>
<p></br></br></p>
</div>
<div id="propbability-of-each-level-of-happinesssatisfaction-at-different-levels-of-freedom" class="section level3">
<h3>Propbability of each level of happiness/satisfaction at different levels of Freedom</h3>
<pre class="r"><code>#### FUNCTION: plotEffect()
plotProbEffect &lt;- function(ef.obj){
  # PREPARE DATA ---
  df &lt;- cbind(ef.obj$x, ef.obj$prob)
  
  # RESHAPE DATA ---
  dm &lt;- reshape2::melt(df, id.vars=&quot;FREEDOM_CHOICE&quot;, value.name=&quot;PROBABILITY&quot;)
  colnames(dm) &lt;- c(&quot;FREEDOM_CHOICE&quot;,&quot;SATISFACTION_LEVEL&quot;,&quot;PROBABILITY&quot;)
  dm$SATISFACTION_LEVEL &lt;- str_replace_all(dm$SATISFACTION_LEVEL, &quot;prob.X&quot;, &quot;&quot;)
  
  # FACTORIZE ---
  dm$FREEDOM_CHOICE &lt;- as.numeric(as.character(dm$FREEDOM_CHOICE))
  dm$SATISFACTION_LEVEL &lt;- as.factor(as.numeric(dm$SATISFACTION_LEVEL))
  
  # COLOR PALETTE
  cpalette &lt;- rev(c(&quot;#e31a1c&quot;,&quot;#a6cee3&quot;,&quot;#1f78b4&quot;,&quot;#b2df8a&quot;,&quot;#33a02c&quot;,
                  &quot;#fb9a99&quot;,&quot;#fdbf6f&quot;,&quot;#ff7f00&quot;,&quot;#cab2d6&quot;,&quot;#6a3d9a&quot;))
  # PLOT ---
  p &lt;- ggplot(data = dm, aes(x=FREEDOM_CHOICE, y=PROBABILITY)) +
              geom_line(aes(y=PROBABILITY, color=SATISFACTION_LEVEL), size=1.5) +
              geom_point(aes(y=PROBABILITY, color=SATISFACTION_LEVEL), size=3) +
              scale_x_continuous(breaks=c(1:10), labels=c(1:10)) +
              scale_y_continuous(breaks=seq(0,0.6,0.1)) +
              scale_color_manual(values=cpalette, name=&quot;Satisfaction Level&quot;) +
              theme(
                axis.text.x = element_text(size = 10, color=&quot;#000000&quot;),
                axis.text.y = element_text(size = 10, color=&quot;#000000&quot;),
                axis.title = element_text(size = 10, color=&quot;#000000&quot;),
                plot.title = element_text(size = 10, color=&quot;#000000&quot;, hjust=0.5),
                panel.grid.major = element_blank(),
                panel.grid.minor = element_blank(),
                axis.ticks = element_line(size=0.4, color=&quot;#000000&quot;),   
                strip.text = element_text(size=10, color=&quot;#000000&quot;),
                strip.background = element_rect(fill=&quot;#FFFFFF&quot;, color=&quot;#FFFFFF&quot;),
                panel.background = element_rect(fill=&quot;#FFFFFF&quot;, color=&quot;#000000&quot;),
                legend.text = element_text(size = 10, color=&quot;#000000&quot;),
                legend.title = element_text(size = 10, color=&quot;#000000&quot;),
                legend.key.size = unit(0.5, &quot;cm&quot;),
                legend.background = element_blank(),
                legend.box.background = element_blank(),
                legend.position = &quot;bottom&quot;) +
            ylab(&quot;Probability of Satisfaction&quot;) +
            xlab(&quot;Freedom of Choice&quot;) + 
            ggtitle(&quot;&quot;)
            
  
    return(p)
}</code></pre>
<pre class="r"><code>plotProbEffect(ef.obj=ef3)</code></pre>
<p><img src="regression_analysis_files/figure-html/unnamed-chunk-23-1.png" width="576" style="display: block; margin: auto;" /></p>
<p></br></br></p>
</div>
<div id="robustness-check-for-proportional-odds-assumption" class="section level3">
<h3>Robustness Check for proportional Odds assumption</h3>
<pre class="r"><code>suppressWarnings(brant(fit.m))</code></pre>
<pre><code>## ---------------------------------------------------- 
## Test for     X2  df  probability 
## ---------------------------------------------------- 
## Omnibus          5928.51 120 0
## SEXFemale        27.11   8   0
## ETHNICITYChhetri 2.2 8   0.97
## ETHNICITYDalit-Others    2.17    8   0.98
## ETHNICITYGurung-Magar    2.86    8   0.94
## ETHNICITYNewar       5.42    8   0.71
## ETHNICITYTamang  1.9 8   0.98
## FREEDOM_CHOICE2  19.35   8   0.01
## FREEDOM_CHOICE3  9.99    8   0.27
## FREEDOM_CHOICE4  10.65   8   0.22
## FREEDOM_CHOICE5  10.2    8   0.25
## FREEDOM_CHOICE6  27.36   8   0
## FREEDOM_CHOICE7  25.44   8   0
## FREEDOM_CHOICE8  13.19   8   0.11
## FREEDOM_CHOICE9  4.92    8   0.77
## FREEDOM_CHOICE10 12.01   8   0.15
## ---------------------------------------------------- 
## 
## H0: Parallel Regression Assumption holds</code></pre>
<pre><code>##                                X2  df  probability
## Omnibus               5928.509021 120 0.0000000000
## SEXFemale               27.112382   8 0.0006760777
## ETHNICITYChhetri         2.199557   8 0.9742745286
## ETHNICITYDalit-Others    2.166315   8 0.9754837970
## ETHNICITYGurung-Magar    2.864757   8 0.9425557787
## ETHNICITYNewar           5.419212   8 0.7119732074
## ETHNICITYTamang          1.898275   8 0.9839731742
## FREEDOM_CHOICE2         19.347883   8 0.0131058967
## FREEDOM_CHOICE3          9.988154   8 0.2658583091
## FREEDOM_CHOICE4         10.648955   8 0.2223939392
## FREEDOM_CHOICE5         10.203099   8 0.2510594492
## FREEDOM_CHOICE6         27.361064   8 0.0006123065
## FREEDOM_CHOICE7         25.436778   8 0.0013104830
## FREEDOM_CHOICE8         13.187097   8 0.1055722918
## FREEDOM_CHOICE9          4.919087   8 0.7661881672
## FREEDOM_CHOICE10        12.009860   8 0.1507645135</code></pre>
<p></br></br></p>
</div>
<div id="robustness-check-with-an-alternative-model-vgam" class="section level3">
<h3>Robustness Check with an Alternative Model: VGAM</h3>
<pre class="r"><code>m_glm &lt;- suppressWarnings(VGAM::vglm(SATISFACTION_LEVEL~FREEDOM_CHOICE+ETHNICITY+SEX, data = dat,
                    family = VGAM::cumulative(link = &quot;logitlink&quot;, parallel = TRUE, reverse = FALSE)))</code></pre>
<pre class="r"><code>Anova(m_glm)</code></pre>
<pre><code>## Analysis of Deviance Table (Type II tests)
## 
## Response: SATISFACTION_LEVEL
##                Df    Chisq Pr(&gt;Chisq)    
## FREEDOM_CHOICE  9 104.8817  &lt; 2.2e-16 ***
## ETHNICITY       5  18.5139   0.002367 ** 
## SEX             1   3.9999   0.045502 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>summary(m_glm)</code></pre>
<pre><code>## 
## Call:
## VGAM::vglm(formula = SATISFACTION_LEVEL ~ FREEDOM_CHOICE + ETHNICITY + 
##     SEX, family = VGAM::cumulative(link = &quot;logitlink&quot;, parallel = TRUE, 
##     reverse = FALSE), data = dat)
## 
## Coefficients: 
##                        Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept):1         -4.354025   0.638561  -6.818 9.20e-12 ***
## (Intercept):2         -3.637775   0.533109  -6.824 8.87e-12 ***
## (Intercept):3         -3.125420   0.487341  -6.413 1.42e-10 ***
## (Intercept):4         -2.276158   0.446475  -5.098 3.43e-07 ***
## (Intercept):5         -0.008954   0.431941  -0.021 0.983461    
## (Intercept):6          0.742839   0.434555   1.709 0.087372 .  
## (Intercept):7          1.517922   0.438535   3.461 0.000537 ***
## (Intercept):8          2.396974   0.445326   5.383 7.35e-08 ***
## (Intercept):9          2.914447   0.451573   6.454 1.09e-10 ***
## FREEDOM_CHOICE2       -1.090869   0.711163  -1.534 0.125049    
## FREEDOM_CHOICE3       -0.901337   0.514888  -1.751 0.080024 .  
## FREEDOM_CHOICE4       -0.842026   0.426266  -1.975 0.048228 *  
## FREEDOM_CHOICE5       -1.003626   0.384186  -2.612 0.008992 ** 
## FREEDOM_CHOICE6       -1.895944   0.405236  -4.679 2.89e-06 ***
## FREEDOM_CHOICE7       -2.245502   0.407632  -5.509 3.62e-08 ***
## FREEDOM_CHOICE8       -2.657949   0.516012  -5.151 2.59e-07 ***
## FREEDOM_CHOICE9       -3.680532   0.533739  -6.896 5.36e-12 ***
## FREEDOM_CHOICE10      -3.397616   0.432264  -7.860 3.84e-15 ***
## ETHNICITYChhetri       0.427046   0.386501   1.105 0.269202    
## ETHNICITYDalit-Others  0.585372   0.393843   1.486 0.137198    
## ETHNICITYGurung-Magar  0.852089   0.352033   2.420 0.015500 *  
## ETHNICITYNewar         0.617323   0.418800   1.474 0.140474    
## ETHNICITYTamang        1.290198   0.339337   3.802 0.000143 ***
## SEXFemale              0.385026   0.192515   2.000 0.045502 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Number of linear predictors:  9 
## 
## Names of linear predictors: logitlink(P[Y&lt;=1]), logitlink(P[Y&lt;=2]), 
## logitlink(P[Y&lt;=3]), logitlink(P[Y&lt;=4]), logitlink(P[Y&lt;=5]), logitlink(P[Y&lt;=6]), 
## logitlink(P[Y&lt;=7]), logitlink(P[Y&lt;=8]), logitlink(P[Y&lt;=9])
## 
## Residual deviance: 1339.561 on 3405 degrees of freedom
## 
## Log-likelihood: -669.7804 on 3405 degrees of freedom
## 
## Number of Fisher scoring iterations: 9 
## 
## Warning: Hauck-Donner effect detected in the following estimate(s):
## &#39;(Intercept):1&#39;
## 
## 
## Exponentiated coefficients:
##       FREEDOM_CHOICE2       FREEDOM_CHOICE3       FREEDOM_CHOICE4 
##            0.33592444            0.40602629            0.43083678 
##       FREEDOM_CHOICE5       FREEDOM_CHOICE6       FREEDOM_CHOICE7 
##            0.36654797            0.15017654            0.10587437 
##       FREEDOM_CHOICE8       FREEDOM_CHOICE9      FREEDOM_CHOICE10 
##            0.07009183            0.02520957            0.03345291 
##      ETHNICITYChhetri ETHNICITYDalit-Others ETHNICITYGurung-Magar 
##            1.53272281            1.79565969            2.34454039 
##        ETHNICITYNewar       ETHNICITYTamang             SEXFemale 
##            1.85395840            3.63350533            1.46965287</code></pre>
<pre class="r"><code>is.parallel(m_glm)</code></pre>
<pre><code>##    (Intercept) FREEDOM_CHOICE      ETHNICITY            SEX 
##          FALSE           TRUE           TRUE           TRUE</code></pre>
</div>
<div id="robustness-check-ols-model" class="section level3">
<h3>Robustness Check: OLS Model</h3>
<pre class="r"><code>dat$SATISFACTION_LEVEL &lt;- as.numeric(dat$SATISFACTION_LEVEL)
fit_lin &lt;- lm(SATISFACTION_LEVEL~SEX+ETHNICITY+FREEDOM_CHOICE, data=dat)

lmtest::coeftest(fit_lin, vcov = sandwich::vcovHC(fit_lin, type = &quot;HC0&quot;))</code></pre>
<pre><code>## 
## t test of coefficients:
## 
##                       Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)            6.22825    0.43780 14.2264 &lt; 2.2e-16 ***
## SEXFemale             -0.24011    0.17847 -1.3454 0.1793355    
## ETHNICITYChhetri      -0.44600    0.36866 -1.2098 0.2271474    
## ETHNICITYDalit-Others -0.73752    0.36165 -2.0393 0.0421384 *  
## ETHNICITYGurung-Magar -0.87009    0.34342 -2.5336 0.0117070 *  
## ETHNICITYNewar        -0.60366    0.38294 -1.5764 0.1158059    
## ETHNICITYTamang       -1.35496    0.32976 -4.1090 4.911e-05 ***
## FREEDOM_CHOICE2        0.79425    1.13869  0.6975 0.4859261    
## FREEDOM_CHOICE3        0.50397    0.49797  1.0120 0.3121921    
## FREEDOM_CHOICE4        0.72167    0.43444  1.6611 0.0975450 .  
## FREEDOM_CHOICE5        0.86855    0.41681  2.0838 0.0378716 *  
## FREEDOM_CHOICE6        1.52355    0.40522  3.7599 0.0001979 ***
## FREEDOM_CHOICE7        1.97191    0.41256  4.7797 2.549e-06 ***
## FREEDOM_CHOICE8        2.34964    0.50468  4.6557 4.527e-06 ***
## FREEDOM_CHOICE9        3.35176    0.48352  6.9321 1.890e-11 ***
## FREEDOM_CHOICE10       2.79334    0.48732  5.7321 2.080e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
